def gs    // define a variable for the external groovy script (gs.groovy)

pipeline{
    agent any
    stages{
        stage("load-script"){
            steps{
                script{
                    gs = load "gs.groovy"
                }
            }
        }
        /* 
        stage("build-vote-image"){
            steps{
                script{
                    gs.build('hamdiz0/va-vote','2.0','docker-repo','./vote')    // calling the build function from the external script
                }
            }
        }
        stage("build-result-image"){
            steps{
                script{
                    gs.build('hamdiz0/va-result','2.0','docker-repo','./result')
                }
            }
        }
        stage("build-worker-image"){
            steps{
                script{
                    gs.build('hamdiz0/va-worker','2.0','docker-repo','./worker')
                }
            }
        }
        */
        stage("deploy app"){
            steps{
                sshagent(credentials:['local-k8s']){
                    /*sh 'ssh -o StrictHostKeyChecking=no vagrant@192.168.1.22'*/
                    sh 'ls -l'
                }
            }
        }
    }
}
