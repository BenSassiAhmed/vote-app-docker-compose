def gs    // define a variable for the external groovy script (gs.groovy)

pipeline{
    agent any
    stages{
        stage("load-script"){
            steps{
                script{
                    gs = load "gs.groovy"
                }
            }
        }
        stage("build-vote-image"){
            steps{
                script{
                    gs.build('hamdiz0/va-vote','1.0','docker-repo','./vote')    // calling the build function from the external script
                }
            }
        }
        stage("build-result-image"){
            steps{
                script{
                    gs.build('hamdiz0/va-result','1.0','docker-repo','./result')
                }
            }
        }
        stage("build-worker-image"){
            steps{
                script{
                    gs.build('hamdiz0/va-worker','1.0','docker-repo','./worker')
                }
            }
        }
    }
}
